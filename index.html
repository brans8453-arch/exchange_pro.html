<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Global Exchange</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{margin:0;font-family:Segoe UI,Arial;background:#0b0e11;color:#fff;font-size:12px}
header{background:#111;padding:8px;display:flex;justify-content:space-between}
h1{color:#ff9900;font-size:15px;margin:0}
.container{display:grid;grid-template-columns:3fr 1fr;gap:8px;padding:8px}
.box{background:#131722;padding:8px;border-radius:6px;margin-bottom:8px}
button,input,select{width:100%;padding:6px;margin-top:4px;border:none;border-radius:4px;font-size:12px}
.buy{background:#0ecb81}
.sell{background:#f6465d}
.green{color:#0ecb81}
.red{color:#f6465d}
.balance{background:#1a1a1a;padding:5px;border-radius:5px}
footer{text-align:center;background:#111;padding:6px}
.modal{position:fixed;width:100%;height:100%;background:#0009;display:none;justify-content:center;align-items:center}
.modal-content{background:#131722;padding:15px;border-radius:6px;width:90%;max-width:400px}
table{width:100%;border-collapse:collapse}
td{padding:3px;border-bottom:1px solid #222}
@media(max-width:900px){.container{grid-template-columns:1fr}}
</style>
</head>

<body>

<header>
<h1>GLOBAL EXCHANGE</h1>
<div class="balance">USDT: <b id="balance">******</b></div>
</header>

<div class="container">

<div>
<div class="box"><canvas id="chart"></canvas></div>

<div class="box">
<h3>Marché</h3>
<table>
<tr><td>BTC</td><td id="BTC" class="green">42000</td></tr>
<tr><td>ETH</td><td id="ETH" class="green">2300</td></tr>
</table>
</div>
</div>

<div>

<div class="box">
<h3>Dashboard</h3>
<button onclick="toggleBalance()">Afficher solde</button>
<button onclick="modal('deposit')">Dépôt</button>
<button onclick="modal('withdraw')">Retrait</button>
<button onclick="modal('send')">Envoyer</button>
</div>

<div class="box">
<h3>Trading</h3>
<select id="pair"><option>BTC</option><option>ETH</option></select>
<input id="qty" placeholder="Quantité">
<button class="buy" onclick="trade('buy')">Acheter</button>
<button class="sell" onclick="trade('sell')">Vendre</button>
</div>

</div>
</div>

<footer>Exchange Demo sécurisé</footer>

<div class="modal" id="modal">
<div class="modal-content" id="modalContent"></div>
</div>

<script>
let wallet={USDT:10000,BTC:0,ETH:0};
let prices={BTC:42000,ETH:2300};
let balanceVisible=false;

function toggleBalance(){
balanceVisible=!balanceVisible;
document.getElementById("balance").textContent=
balanceVisible?wallet.USDT.toFixed(2):"******";
}

function trade(side){
let pair=document.getElementById("pair").value;
let qty=parseFloat(document.getElementById("qty").value);
if(!qty)return alert("Quantité invalide");
let total=qty*prices[pair];

if(side=="buy"){
if(wallet.USDT<total)return alert("Solde insuffisant");
wallet.USDT-=total;
wallet[pair]+=qty;
}else{
if(wallet[pair]<qty)return alert("Crypto insuffisante");
wallet[pair]-=qty;
wallet.USDT+=total;
}
toggleBalance();toggleBalance();
alert("Trade réussi");
}

function modal(type){
let c=document.getElementById("modalContent");

if(type=="deposit")
c.innerHTML="<h3>Dépôt</h3><input id='dep'><button onclick='deposit()'>Confirmer</button>";

if(type=="withdraw")
c.innerHTML="<h3>Retrait</h3>\
<input id='dest' placeholder='Destinataire'>\
<input id='amount' placeholder='Montant'>\
<button onclick='generateCode()'>Générer code</button>";

if(type=="send")
c.innerHTML="<h3>Envoyer</h3>\
<input id='sendDest' placeholder='ID utilisateur'>\
<input id='sendAmt' placeholder='Montant'>\
<button onclick='sendMoney()'>Envoyer</button>";

document.getElementById("modal").style.display="flex";
}

function deposit(){
wallet.USDT+=parseFloat(document.getElementById("dep").value);
toggleBalance();toggleBalance();
closeModal();
}

function generateCode(){
let code=Math.floor(Math.random()*900000)+100000;
document.getElementById("modalContent").innerHTML+=
"<p>Code: "+code+"</p>\
<input id='confirmCode' placeholder='Entrer code'>\
<button onclick='confirmWithdraw("+code+")'>Confirmer</button>";
}

function confirmWithdraw(code){
let userCode=parseInt(document.getElementById("confirmCode").value);
let amt=parseFloat(document.getElementById("amount").value);

if(userCode!==code)return alert("Code invalide");

wallet.USDT-=amt;
toggleBalance();toggleBalance();
alert("Retrait envoyé au destinataire");
closeModal();
}

function sendMoney(){
let amt=parseFloat(document.getElementById("sendAmt").value);
wallet.USDT-=amt;
toggleBalance();toggleBalance();
alert("Envoyé avec succès");
closeModal();
}

function closeModal(){
document.getElementById("modal").style.display="none";
}

function marketMove(){
for(let p in prices){
let m=(Math.random()*2-1)*100;
prices[p]+=m;
let el=document.getElementById(p);
el.textContent=Math.round(prices[p]);
el.className=m>=0?"green":"red";
}
updateChart();
}
setInterval(marketMove,3000);

const ctx=document.getElementById("chart");
let data=[42000,42200,42100,42400,42300];
let chart=new Chart(ctx,{
type:"line",
data:{labels:[1,2,3,4,5],
datasets:[{data:data,borderColor:"#ff9900"}]},
options:{plugins:{legend:{display:false}}}
});

function updateChart(){
data.push(prices.BTC);
data.shift();
chart.data.datasets[0].data=data;
chart.update();
}
</script>

</body>
</html>
